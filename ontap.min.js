(function(e){"use strict";function N(e,t,n,r,i){var s,o=0;while(s=e.parent[o++]){s[b]||(s[b]={});var u=s[b],a=u[t];a?a[i]?a[i].push(n):a[i]=[n]:(u[t]={},u[t][i]=[n],s[l]("touchstart",T)),r&&(s.active=r)}}function C(e,t,n,r){if(typeof e==h)N(n,"this",e,t,r);else if(typeof e==p)for(var i in e)N(n,i,e[i],t,r);return n}function k(e,t,n,r){var i,s,o=0,u=0,a;while(s=e.parent[o++])if(s[b]&&s[b][t]){a=s[b][t];while(i=a[n][u])i===r&&a[n].splice(u,1),u++}}var t=500,n=5,r,i,s=[],o,u,a,f=Math.abs,l="addEventListener",c="removeEventListener",h="function",p="object",d="string",v="touches",m="length",g=setTimeout,y=clearTimeout,b="tap3vents",w=function(e,t,n){e[t]("touchmove",x),e[t]("touchend",S),e[t]("touchcancel",S);if(n&&e.active&&s[m]>0){var r=s[0][1];r.className=r.className.replace(" "+e.active,"")}return t==c&&(s[m]=0),y(o),1},E=function(e,t,n,r){if(e){var i=e[m];while(i--)if(e[i].call(t,n,r)===!1)break}},S=function(e){if(s[m]>0){clearTimeout(a);var t=0,n;while(n=s[t++]){var r=this[b][n[0]],i=r.tap,o=r.dblTap,f=e.changedTouches[0],l=e.target;o?l.tapped?(y(u),l.tapped=!1,E(o,n[1],f,e)):(l.tapped=!0,u=g(function(e,t,n,r){return function(){r.target.tapped=!1,E(e,t,n,r)}}(i,n[1],f,e),250)):E(i,n[1],f,e)}}w(this,c,!0)},x=function(e){var t=e[v][0];!(f(t.pageX-r)>n||f(t.pageY-i)>n)&&w(this,c,!0)&&clearTimeout(a)},T=function(e){var n=e.target,u=this[b],f;for(f in u)if(f=="this"||n.matchesSelector(f)){s.push([f,n]);var h=e[v][0],p=u[f].hold;r=h.pageX,i=h.pageY,p?a=g(function(e,t,n,r,i){return function(){s[m]>0&&E(e,t,n,r),w(i,c,!0)}}(p,n,h,e,this),t):w(this,l),o=g(function(e){return function(){e.active&&(n.className+=" "+e.active)}}(this),60)}};e.on=function(e){return{parent:typeof e==d?document.querySelectorAll(e):e instanceof NodeList?e:[e],tap:function(e,t){return C(e,t,this,"tap")},removeAll:function(){var e=this.parent,t=e[m];while(t--)delete e[t][b]},dblTap:function(t,n){return C(t,n,this,"dblTap")},hold:function(e,t){return C(e,t,this,"hold")},remove:function(e,t){if(typeof t==h)k(this,"this",e,t);else if(typeof t==p)for(var n in t)k(this,n,e,t[n])}}}})(window)